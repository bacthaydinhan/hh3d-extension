<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug VanDap Extension</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .question { font-size: 18px; font-weight: bold; margin: 10px 0; }
        .option { display: block; margin: 5px 0; padding: 10px; background: #f0f0f0; cursor: pointer; }
        .option:hover { background: #e0e0e0; }
        .log { background: #f9f9f9; padding: 10px; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>üîß Debug VanDap Extension</h1>
    
    <div class="debug-section">
        <h2>Test Question Detection</h2>
        <div id="question" class="question">Trong phim Ti√™n Ngh·ªãch, V∆∞∆°ng L√¢m v√¥ t√¨nh c√≥ ƒë∆∞·ª£c ph√°p b·∫£o ngh·ªãch thi√™n n√†o ?</div>
        
        <h3>Options:</h3>
        <button class="option" data-index="0">C√¥n C·ª±c Ti√™n</button>
        <button class="option" data-index="1">Thi√™n Ngh·ªãch Ch√¢u</button>
        <button class="option" data-index="2">ƒêi·ªÉm Ti√™n B√∫t</button>
        <button class="option" data-index="3">C·∫•m Phi√™n</button>
    </div>
    
    <div class="debug-section">
        <h2>Extension Status</h2>
        <div id="status">Checking...</div>
    </div>
    
    <div class="debug-section">
        <h2>Debug Log</h2>
        <div id="debugLog" class="log">Extension loading...</div>
    </div>
    
    <script>
        // Debug logging
        function addLog(message) {
            const log = document.getElementById('debugLog');
            const timestamp = new Date().toLocaleTimeString();
            log.textContent += `[${timestamp}] ${message}\n`;
            log.scrollTop = log.scrollHeight;
            console.log(`[Debug] ${message}`);
        }
        
        // Check extension status
        function checkExtensionStatus() {
            const status = document.getElementById('status');
            
            if (window.vanDapHelper) {
                status.innerHTML = '‚úÖ Extension loaded successfully';
                addLog('Extension detected and loaded');
                
                // Test question detection
                setTimeout(() => {
                    addLog('Testing question detection...');
                    const question = window.vanDapHelper.detectCurrentQuestion();
                    addLog(`Detected question: ${question || 'NONE'}`);
                    
                    // Test options detection
                    const options = window.vanDapHelper.getAvailableOptions();
                    addLog(`Detected ${options.length} options: ${options.map(o => o.text).join(', ')}`);
                    
                    // Test answer finding
                    if (question) {
                        const answerData = window.vanDapHelper.findAnswer(question);
                        addLog(`Found answer: ${answerData ? answerData.dap_an : 'NONE'}`);
                    }
                }, 1000);
            } else {
                status.innerHTML = '‚ùå Extension not loaded';
                addLog('Extension not detected');
            }
        }
        
        // Add click handlers to options
        document.querySelectorAll('.option').forEach((option, index) => {
            option.addEventListener('click', () => {
                addLog(`Option ${index + 1} clicked: "${option.textContent}"`);
                option.style.background = '#90EE90';
                setTimeout(() => {
                    option.style.background = '#f0f0f0';
                }, 1000);
            });
        });
        
        // Check status periodically
        setInterval(checkExtensionStatus, 2000);
        
        // Initial check
        setTimeout(checkExtensionStatus, 500);
        
        addLog('Debug page loaded');
    </script>
</body>
</html>